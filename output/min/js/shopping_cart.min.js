"use strict";define(["jquery","jquery_cookie"],function(r){function v(){var e=r.cookie("goods"),n=0;if(e)for(var i=JSON.parse(e),t=0;t<i.length;t++)n+=i[t].num;else r(".text_choose_all").prev().removeClass("checkbox_on"),r(".total_num").find("h4 i").text(0),r(".total_num").find("h5 i").text(0),r(".total_price").find("h4 i span").text(0);r(".total_num").find("h5 i").text(n);var s=r(".cart_insert").find(".checkbox_on"),o=0,a=0;if(s.length)for(var c=0;c<s.length;c++){var d=s.eq(c).closest("div.divide");o+=Number(d.find("input[name='number']").val()),a+=Number(d.find(".subtotal span").text())}else a=o=0;r(".total_num").find("h4 i").text(o),o==n?r(".text_choose_all").prev().addClass("checkbox_on"):r(".text_choose_all").prev().removeClass("checkbox_on"),r(".total_price").find("h4 i span").text(a)}return{check:function(){console.log("shopping_cart.js开始执行"),console.log(r?"ok":"error")},c_m:function(){var l=r.cookie("goods");if(!l)return r(".cart_insert").html(""),r(".text_choose_all").prev().removeClass("checkbox_on"),r(".total_num").find("h4 i").text(0),r(".total_num").find("h5 i").text(0),void r(".total_price").find("h4 i span").text(0);r(".text_choose_all").prev().addClass("checkbox_on"),r.ajax({url:"../json/hot_goods.json",success:function(e){for(var n=e.data.list,i=JSON.parse(l),t=[],s=0;s<n.length;s++)for(var o=0;o<i.length;o++)if(i[o].id==n[s].id){t.push({id:n[s].id,num:i[o].num,name:n[s].name,title:n[s].shop_info.title,sub_title:n[s].shop_info.sub_title,price:n[s].price,image:n[s].shop_info.ali_image,note:n[s].shop_info.spec_json[0].item_value});break}for(var a="",c=0;c<t.length;c++){var d=Number(t[c].price)*Number(t[c].num);a+='\n          <div class="divide" data-id="'+t[c].id+'">\n            \x3c!----\x3e\n            <div class="cart_items">\n              \x3c!----\x3e\n              <div class="cart_item">\n                <div class="checkbox_container">\n                  <span class="m_blue_checkbox_new checkbox_on"> </span>\n                </div>\n                <div class="item_wrapper">\n                  <div class="items_thumb">\n                    <img height="80" width="80" src="'+t[c].image+'" alt="'+t[c].title+'">\n                    <a target="_blank" title="'+t[c].title+'" href="https://www.smartisan.com/item/'+t[c].id+'"></a>\n                  </div>\n                  <div class="name hide_row">\n                    <div class="name_table">\n                      <a target="_blank" title="'+t[c].title+'" href="https://www.smartisan.com/item/'+t[c].id+'">'+t[c].title+'</a>\n                      <ul class="attribute clearfix">\n                        <li>'+t[c].note+'</li>\n                      </ul>\n                    </div>\n                  </div>\n                  <div class="operation">\n                    <a class="items_delete_btn" data-id="'+t[c].id+'"></a>\n                  </div>\n                  <div>\n                    \x3c!----\x3e\n                    <div class="subtotal">\n                      <i>¥</i>\n                      <span>'+d+'</span>\n                    </div>\n                    \x3c!----\x3e\n                    <div class="item_cols_num">\n                      \x3c!----\x3e\n                      <div class="quantity">\n                        <span class="button down disabled"></span>\n                        <span class="num">\n                          <input name=\'number\' readonly="readonly" type="number" value="'+t[c].num+'">\n                        </span>\n                        <span class="button up"></span>\n                        \x3c!----\x3e\n                      </div>\n                      \x3c!----\x3e\n                      \x3c!----\x3e\n                    </div>\n                    <div class="price">\n                      <i>¥</i>\n                      <span>'+t[c].price+"</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          "}r(".cart_insert").html(a),console.log("加载购物车页面完成"),v()},error:function(e){console.log(e)}})},t_d:v,c_o:function(){r(".cart_insert").on("click","span.m_blue_checkbox_new",function(){r(this).hasClass("checkbox_on")?r(this).removeClass("checkbox_on"):r(this).addClass("checkbox_on"),v()}),r(".js_choose_all span.m_blue_checkbox_new").click(function(){r(this).hasClass("checkbox_on")?r("span.m_blue_checkbox_new").removeClass("checkbox_on"):r("span.m_blue_checkbox_new").addClass("checkbox_on"),v()}),r(".cart_insert").on("click","span.button.down",function(){var e=r(this).next(".num").find("input"),n=Number(r(this).closest("div.divide").attr("data-id")),i=Number(e.val());--i<=1&&(r(this).addClass("disabled"),i=1),e.val(i);var t=Number(r(this).closest("div.divide").find("div.price span").text())*i;r(this).closest("div.divide").find("div.subtotal span").text(t);var s=JSON.parse(r.cookie("goods")),o=s.findIndex(function(e){return e.id==n});s[o].num=i,r.cookie("goods",JSON.stringify(s),{expires:7,path:"/"}),v()}),r(".cart_insert").on("click","span.button.up",function(){var e=r(this).prev(".num").find("input"),n=Number(r(this).closest("div.divide").attr("data-id")),i=Number(e.val());i++,r(this).closest("div.divide").find(".button.down").removeClass("disabled"),e.val(i);var t=Number(r(this).closest("div.divide").find("div.price span").text())*i;r(this).closest("div.divide").find("div.subtotal span").text(t);var s=JSON.parse(r.cookie("goods")),o=s.findIndex(function(e){return e.id==n});s[o].num=i,r.cookie("goods",JSON.stringify(s),{expires:7,path:"/"}),v()}),r(".cart_insert").on("click",".items_delete_btn",function(){var n=Number(r(this).attr("data-id"));r(this).closest("div.divide").remove();var e=JSON.parse(r.cookie("goods")),i=e.findIndex(function(e){return e.id==n});e.splice(i,1),e.length?r.cookie("goods",JSON.stringify(e),{expires:7,path:"/"}):r.cookie("goods",null,{path:"/"}),v()}),r(".delete_choose_goods").click(function(){var s=r(".cart_insert").find(".checkbox_on"),o=JSON.parse(r.cookie("goods"));if(s.length){for(var e=0;e<s.length;e++)!function(e){var n=s.eq(e).closest("div.divide"),i=Number(n.attr("data-id"));n.remove();var t=o.findIndex(function(e){return e.id==i});o.splice(t,1)}(e);o.length?r.cookie("goods",JSON.stringify(o),{expires:7,path:"/"}):r.cookie("goods",null,{path:"/"}),v()}})},end:function(){console.log("shopping_cart.js执行结束")}}});